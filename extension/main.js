var A=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function G(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function V(i){if(i.__esModule)return i;var e=i.default;if(typeof e=="function"){var o=function n(){if(this instanceof n){var u=[null];u.push.apply(u,arguments);var r=Function.bind.apply(e,u);return new r}return e.apply(this,arguments)};o.prototype=e.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(i).forEach(function(n){var u=Object.getOwnPropertyDescriptor(i,n);Object.defineProperty(o,n,u.get?u:{enumerable:!0,get:function(){return i[n]}})}),o}var C={},H={get exports(){return C},set exports(i){C=i}},R={},c={};Object.defineProperty(c,"__esModule",{value:!0});c.toDurationString=c.toJSON=c.isRRule=c.isMomentDuration=c.isLuxonDate=c.isDayjs=c.isMomentTZ=c.isMoment=c.toDate=c.checkDate=c.checkEnum=c.checkNameAndMail=c.generateCustomAttributes=c.addOrGetCustomAttributes=c.foldLines=c.escape=c.formatDateTZ=c.formatDate=void 0;function j(i,e,o,n){if(i!=null&&i.startsWith("/")&&(i=i.substr(1)),typeof e=="string"||e instanceof Date){const u=new Date(e);let r=u.getUTCFullYear()+String(u.getUTCMonth()+1).padStart(2,"0")+u.getUTCDate().toString().padStart(2,"0");return i&&(r=u.getFullYear()+String(u.getMonth()+1).padStart(2,"0")+u.getDate().toString().padStart(2,"0")),o?r:i?(r+="T"+u.getHours().toString().padStart(2,"0")+u.getMinutes().toString().padStart(2,"0")+u.getSeconds().toString().padStart(2,"0"),r):(r+="T"+u.getUTCHours().toString().padStart(2,"0")+u.getUTCMinutes().toString().padStart(2,"0")+u.getUTCSeconds().toString().padStart(2,"0")+(n?"":"Z"),r)}else if(S(e)){const u=i?B(e)&&!e.tz()?e.clone().tz(i):e:n?e:e.utc();return u.format("YYYYMMDD")+(o?"":"T"+u.format("HHmmss")+(n||i?"":"Z"))}else if(I(e)){const u=i?e.setZone(i):n?e:e.setZone("utc");return u.toFormat("yyyyLLdd")+(o?"":"T"+u.toFormat("HHmmss")+(n||i?"":"Z"))}else{let u=e;if(i)u=typeof e.tz=="function"?e.tz(i):e;else if(!n)if(typeof e.utc=="function")u=e.utc();else throw new Error("Unable to convert dayjs object to UTC value: UTC plugin is not available!");return u.format("YYYYMMDD")+(o?"":"T"+u.format("HHmmss")+(n||i?"":"Z"))}}c.formatDate=j;function k(i,e,o,n){let u="",r=(n==null?void 0:n.floating)||!1;return n!=null&&n.timezone&&(u=";TZID="+n.timezone,r=!0),e+u+":"+j(i,o,!1,r)}c.formatDateTZ=k;function P(i,e){return String(i).replace(e?/[\\;,"]/g:/[\\;,]/g,function(o){return"\\"+o}).replace(/(?:\r\n|\r|\n)/g,"\\n")}c.escape=P;function q(i){return i.split(`\r
`).map(function(e){let o="",n=0;for(let u=0;u<e.length;u++){let r=e.charAt(u);r>="\uD800"&&r<="\uDBFF"&&(r+=e.charAt(++u));const h=new TextEncoder().encode(r).length;n+=h,n>74&&(o+=`\r
 `,n=h),o+=r}return o}).join(`\r
`)}c.foldLines=q;function Z(i,e,o){if(Array.isArray(e))i.x=e.map(n=>{if(Array.isArray(n))return n;if(typeof n.key!="string"||typeof n.value!="string")throw new Error("Either key or value is not a string!");if(n.key.substr(0,2)!=="X-")throw new Error("Key has to start with `X-`!");return[n.key,n.value]});else if(typeof e=="object")i.x=Object.entries(e).map(([n,u])=>{if(typeof n!="string"||typeof u!="string")throw new Error("Either key or value is not a string!");if(n.substr(0,2)!=="X-")throw new Error("Key has to start with `X-`!");return[n,u]});else if(typeof e=="string"&&typeof o=="string"){if(e.substr(0,2)!=="X-")throw new Error("Key has to start with `X-`!");i.x.push([e,o])}else return i.x.map(n=>({key:n[0],value:n[1]}))}c.addOrGetCustomAttributes=Z;function $(i){const e=i.x.map(([o,n])=>o.toUpperCase()+":"+P(n,!1)).join(`\r
`);return e.length?e+`\r
`:""}c.generateCustomAttributes=$;function J(i,e){let o=null;if(typeof e=="string"){const n=e.match(/^(.+) ?<([^>]+)>$/);n?o={name:n[1].trim(),email:n[2].trim()}:e.includes("@")&&(o={name:e.trim(),email:e.trim()})}else typeof e=="object"&&(o={name:e.name,email:e.email,mailto:e.mailto,sentBy:e.sentBy});if(!o&&typeof e=="string")throw new Error("`"+i+"` isn't formated correctly. See https://sebbo2002.github.io/ical-generator/develop/reference/interfaces/ICalOrganizer.html");if(!o)throw new Error("`"+i+"` needs to be a valid formed string or an object. See https://sebbo2002.github.io/ical-generator/develop/reference/interfaces/ICalOrganizer.html");if(!o.name)throw new Error("`"+i+".name` is empty!");return o}c.checkNameAndMail=J;function X(i,e){const o=Object.values(i),n=String(e).toUpperCase();if(!n||!o.includes(n))throw new Error(`Input must be one of the following: ${o.join(", ")}`);return n}c.checkEnum=X;function W(i,e){if(i instanceof Date&&isNaN(i.getTime())||typeof i=="string"&&isNaN(new Date(i).getTime()))throw new Error(`\`${e}\` has to be a valid date!`);if(i instanceof Date||typeof i=="string"||I(i)&&i.isValid===!0||(S(i)||F(i))&&i.isValid())return i;throw new Error(`\`${e}\` has to be a valid date!`)}c.checkDate=W;function K(i){return typeof i=="string"||i instanceof Date?new Date(i):I(i)?i.toJSDate():i.toDate()}c.toDate=K;function S(i){return i!=null&&i._isAMomentObject!=null}c.isMoment=S;function B(i){return S(i)&&"tz"in i&&typeof i.tz=="function"}c.isMomentTZ=B;function F(i){return typeof i=="object"&&i!==null&&!(i instanceof Date)&&!S(i)&&!I(i)}c.isDayjs=F;function I(i){return typeof i=="object"&&i!==null&&"toJSDate"in i&&typeof i.toJSDate=="function"}c.isLuxonDate=I;function Q(i){return i!==null&&typeof i=="object"&&typeof i.asSeconds=="function"}c.isMomentDuration=Q;function x(i){return i!==null&&typeof i=="object"&&typeof i.between=="function"&&typeof i.toString=="function"}c.isRRule=x;function tt(i){return!i||typeof i=="string"?i:i.toJSON()}c.toJSON=tt;function et(i){let e="";return i<0&&(e="-",i*=-1),e+="P",i>=86400&&(e+=Math.floor(i/86400)+"D",i%=86400),!i&&e.length>1||(e+="T",i>=3600&&(e+=Math.floor(i/3600)+"H",i%=3600),i>=60&&(e+=Math.floor(i/60)+"M",i%=60),i>0?e+=i+"S":e.length<=2&&(e+="0S")),e}c.toDurationString=et;var w={};function it(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var O={},nt={get exports(){return O},set exports(i){O=i}};const rt={},at=Object.freeze(Object.defineProperty({__proto__:null,default:rt},Symbol.toStringTag,{value:"Module"})),z=V(at);(function(i){(function(){var e,o=0,n=[],u;for(u=0;u<256;u++)n[u]=(u+256).toString(16).substr(1);a.BUFFER_SIZE=4096,a.bin=s,a.clearBuffer=function(){e=null,o=0},a.test=function(d){return typeof d=="string"?/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(d):!1};var r;typeof crypto<"u"?r=crypto:typeof window<"u"&&typeof window.msCrypto<"u"&&(r=window.msCrypto),typeof it=="function"?(r=r||z,i.exports=a):typeof window<"u"&&(window.uuid=a),a.randomBytes=function(){if(r){if(r.randomBytes)return r.randomBytes;if(r.getRandomValues)return typeof Uint8Array.prototype.slice!="function"?function(d){var m=new Uint8Array(d);return r.getRandomValues(m),Array.from(m)}:function(d){var m=new Uint8Array(d);return r.getRandomValues(m),m}}return function(d){var m,T=[];for(m=0;m<d;m++)T.push(Math.floor(Math.random()*256));return T}}();function h(d){return(!e||o+d>a.BUFFER_SIZE)&&(o=0,e=a.randomBytes(a.BUFFER_SIZE)),e.slice(o,o+=d)}function s(){var d=h(16);return d[6]=d[6]&15|64,d[8]=d[8]&63|128,d}function a(){var d=s();return n[d[0]]+n[d[1]]+n[d[2]]+n[d[3]]+"-"+n[d[4]]+n[d[5]]+"-"+n[d[6]]+n[d[7]]+"-"+n[d[8]]+n[d[9]]+"-"+n[d[10]]+n[d[11]]+n[d[12]]+n[d[13]]+n[d[14]]+n[d[15]]}})()})(nt);var N={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ICalAttendeeType=i.ICalAttendeeStatus=i.ICalAttendeeRole=void 0;const e=c;var o;(function(h){h.CHAIR="CHAIR",h.REQ="REQ-PARTICIPANT",h.OPT="OPT-PARTICIPANT",h.NON="NON-PARTICIPANT"})(o=i.ICalAttendeeRole||(i.ICalAttendeeRole={}));var n;(function(h){h.ACCEPTED="ACCEPTED",h.TENTATIVE="TENTATIVE",h.DECLINED="DECLINED",h.DELEGATED="DELEGATED",h.NEEDSACTION="NEEDS-ACTION"})(n=i.ICalAttendeeStatus||(i.ICalAttendeeStatus={}));var u;(function(h){h.INDIVIDUAL="INDIVIDUAL",h.GROUP="GROUP",h.RESOURCE="RESOURCE",h.ROOM="ROOM",h.UNKNOWN="UNKNOWN"})(u=i.ICalAttendeeType||(i.ICalAttendeeType={}));class r{constructor(s,a){if(this.data={name:null,email:null,mailto:null,sentBy:null,status:null,role:o.REQ,rsvp:null,type:null,delegatedTo:null,delegatedFrom:null,x:[]},this.event=a,!this.event)throw new Error("`event` option required!");s.name!==void 0&&this.name(s.name),s.email!==void 0&&this.email(s.email),s.mailto!==void 0&&this.mailto(s.mailto),s.sentBy!==void 0&&this.sentBy(s.sentBy),s.status!==void 0&&this.status(s.status),s.role!==void 0&&this.role(s.role),s.rsvp!==void 0&&this.rsvp(s.rsvp),s.type!==void 0&&this.type(s.type),s.delegatedTo!==void 0&&this.delegatedTo(s.delegatedTo),s.delegatedFrom!==void 0&&this.delegatedFrom(s.delegatedFrom),s.delegatesTo&&this.delegatesTo(s.delegatesTo),s.delegatesFrom&&this.delegatesFrom(s.delegatesFrom),s.x!==void 0&&this.x(s.x)}name(s){return s===void 0?this.data.name:(this.data.name=s||null,this)}email(s){return s?(this.data.email=s,this):this.data.email}mailto(s){return s===void 0?this.data.mailto:(this.data.mailto=s||null,this)}sentBy(s){return s?(this.data.sentBy=s,this):this.data.sentBy}role(s){return s===void 0?this.data.role:(this.data.role=(0,e.checkEnum)(o,s),this)}rsvp(s){return s===void 0?this.data.rsvp:s===null?(this.data.rsvp=null,this):(this.data.rsvp=!!s,this)}status(s){return s===void 0?this.data.status:s?(this.data.status=(0,e.checkEnum)(n,s),this):(this.data.status=null,this)}type(s){return s===void 0?this.data.type:s?(this.data.type=(0,e.checkEnum)(u,s),this):(this.data.type=null,this)}delegatedTo(s){return s===void 0?this.data.delegatedTo:s?(typeof s=="string"?this.data.delegatedTo=new r((0,e.checkNameAndMail)("delegatedTo",s),this.event):s instanceof r?this.data.delegatedTo=s:this.data.delegatedTo=new r(s,this.event),this.data.status=n.DELEGATED,this):(this.data.delegatedTo=null,this.data.status===n.DELEGATED&&(this.data.status=null),this)}delegatedFrom(s){return s===void 0?this.data.delegatedFrom:(s?typeof s=="string"?this.data.delegatedFrom=new r((0,e.checkNameAndMail)("delegatedFrom",s),this.event):s instanceof r?this.data.delegatedFrom=s:this.data.delegatedFrom=new r(s,this.event):this.data.delegatedFrom=null,this)}delegatesTo(s){const a=s instanceof r?s:this.event.createAttendee(s);return this.delegatedTo(a),a.delegatedFrom(this),a}delegatesFrom(s){const a=s instanceof r?s:this.event.createAttendee(s);return this.delegatedFrom(a),a.delegatedTo(this),a}x(s,a){if(s===void 0)return(0,e.addOrGetCustomAttributes)(this.data);if(typeof s=="string"&&typeof a=="string")(0,e.addOrGetCustomAttributes)(this.data,s,a);else if(typeof s=="object")(0,e.addOrGetCustomAttributes)(this.data,s);else throw new Error("Either key or value is not a string!");return this}toJSON(){var s,a;return Object.assign({},this.data,{delegatedTo:((s=this.data.delegatedTo)===null||s===void 0?void 0:s.email())||null,delegatedFrom:((a=this.data.delegatedFrom)===null||a===void 0?void 0:a.email())||null,x:this.x()})}toString(){let s="ATTENDEE";if(!this.data.email)throw new Error("No value for `email` in ICalAttendee given!");return s+=";ROLE="+this.data.role,this.data.type&&(s+=";CUTYPE="+this.data.type),this.data.status&&(s+=";PARTSTAT="+this.data.status),this.data.rsvp!==null&&(s+=";RSVP="+this.data.rsvp.toString().toUpperCase()),this.data.sentBy!==null&&(s+=';SENT-BY="mailto:'+this.data.sentBy+'"'),this.data.delegatedTo&&(s+=';DELEGATED-TO="'+this.data.delegatedTo.email()+'"'),this.data.delegatedFrom&&(s+=';DELEGATED-FROM="'+this.data.delegatedFrom.email()+'"'),this.data.name&&(s+=';CN="'+(0,e.escape)(this.data.name,!0)+'"'),this.data.email&&this.data.mailto&&(s+=";EMAIL="+(0,e.escape)(this.data.email,!1)),this.data.x.length&&(s+=";"+this.data.x.map(([a,d])=>a.toUpperCase()+"="+(0,e.escape)(d,!1)).join(";")),s+=":MAILTO:"+(0,e.escape)(this.data.mailto||this.data.email,!1)+`\r
`,s}}i.default=r})(N);var M={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ICalAlarmType=void 0;const e=c;var o;(function(u){u.display="display",u.audio="audio"})(o=i.ICalAlarmType||(i.ICalAlarmType={}));class n{constructor(r,h){if(this.data={type:null,trigger:null,repeat:null,interval:null,attach:null,description:null,x:[]},this.event=h,!h)throw new Error("`event` option required!");r.type!==void 0&&this.type(r.type),r.trigger!==void 0&&this.trigger(r.trigger),r.triggerBefore!==void 0&&this.triggerBefore(r.triggerBefore),r.triggerAfter!==void 0&&this.triggerAfter(r.triggerAfter),r.repeat!==void 0&&this.repeat(r.repeat),r.interval!==void 0&&this.interval(r.interval),r.attach!==void 0&&this.attach(r.attach),r.description!==void 0&&this.description(r.description),r.x!==void 0&&this.x(r.x)}type(r){if(r===void 0)return this.data.type;if(!r)return this.data.type=null,this;if(!Object.keys(o).includes(r))throw new Error("`type` is not correct, must be either `display` or `audio`!");return this.data.type=r,this}trigger(r){if(r===void 0&&typeof this.data.trigger=="number")return-1*this.data.trigger;if(r===void 0&&this.data.trigger)return this.data.trigger;if(r===void 0)return null;if(!r)this.data.trigger=null;else if(typeof r=="number"&&isFinite(r))this.data.trigger=-1*r;else{if(typeof r=="number")throw new Error("`trigger` is not correct, must be a finite number or a supported date!");this.data.trigger=(0,e.checkDate)(r,"trigger")}return this}triggerAfter(r){return r===void 0?this.data.trigger:this.trigger(typeof r=="number"?-1*r:r)}triggerBefore(r){return r===void 0?this.trigger():this.trigger(r)}repeat(r){if(r===void 0)return this.data.repeat;if(!r)return this.data.repeat=null,this;if(typeof r!="number"||!isFinite(r))throw new Error("`repeat` is not correct, must be numeric!");return this.data.repeat=r,this}interval(r){if(r===void 0)return this.data.interval||null;if(!r)return this.data.interval=null,this;if(typeof r!="number"||!isFinite(r))throw new Error("`interval` is not correct, must be numeric!");return this.data.interval=r,this}attach(r){if(r===void 0)return this.data.attach;if(!r)return this.data.attach=null,this;let h=null;if(typeof r=="string")h={uri:r,mime:null};else if(typeof r=="object")h={uri:r.uri,mime:r.mime||null};else throw new Error("`attachment` needs to be a valid formed string or an object. See https://sebbo2002.github.io/ical-generator/develop/reference/classes/ICalAlarm.html#attach");if(!h.uri)throw new Error("`attach.uri` is empty!");return this.data.attach={uri:h.uri,mime:h.mime},this}description(r){return r===void 0?this.data.description:r?(this.data.description=r,this):(this.data.description=null,this)}x(r,h){if(r===void 0)return(0,e.addOrGetCustomAttributes)(this.data);if(typeof r=="string"&&typeof h=="string")(0,e.addOrGetCustomAttributes)(this.data,r,h);else if(typeof r=="object")(0,e.addOrGetCustomAttributes)(this.data,r);else throw new Error("Either key or value is not a string!");return this}toJSON(){const r=this.trigger();return Object.assign({},this.data,{trigger:typeof r=="number"?r:(0,e.toJSON)(r),x:this.x()})}toString(){let r=`BEGIN:VALARM\r
`;if(!this.data.type)throw new Error("No value for `type` in ICalAlarm given!");if(!this.data.trigger)throw new Error("No value for `trigger` in ICalAlarm given!");if(r+="ACTION:"+this.data.type.toUpperCase()+`\r
`,typeof this.data.trigger=="number"&&this.data.trigger>0?r+="TRIGGER;RELATED=END:"+(0,e.toDurationString)(this.data.trigger)+`\r
`:typeof this.data.trigger=="number"?r+="TRIGGER:"+(0,e.toDurationString)(this.data.trigger)+`\r
`:r+="TRIGGER;VALUE=DATE-TIME:"+(0,e.formatDate)(this.event.timezone(),this.data.trigger)+`\r
`,this.data.repeat&&!this.data.interval)throw new Error("No value for `interval` in ICalAlarm given, but required for `repeat`!");if(this.data.repeat&&(r+="REPEAT:"+this.data.repeat+`\r
`),this.data.interval&&!this.data.repeat)throw new Error("No value for `repeat` in ICalAlarm given, but required for `interval`!");return this.data.interval&&(r+="DURATION:"+(0,e.toDurationString)(this.data.interval)+`\r
`),this.data.type==="audio"&&this.data.attach&&this.data.attach.mime?r+="ATTACH;FMTTYPE="+(0,e.escape)(this.data.attach.mime,!1)+":"+(0,e.escape)(this.data.attach.uri,!1)+`\r
`:this.data.type==="audio"&&this.data.attach?r+="ATTACH;VALUE=URI:"+(0,e.escape)(this.data.attach.uri,!1)+`\r
`:this.data.type==="audio"&&(r+=`ATTACH;VALUE=URI:Basso\r
`),this.data.type==="display"&&this.data.description?r+="DESCRIPTION:"+(0,e.escape)(this.data.description,!1)+`\r
`:this.data.type==="display"&&(r+="DESCRIPTION:"+(0,e.escape)(this.event.summary(),!1)+`\r
`),r+=(0,e.generateCustomAttributes)(this.data),r+=`END:VALARM\r
`,r}}i.default=n})(M);var v={};Object.defineProperty(v,"__esModule",{value:!0});const st=c;class ot{constructor(e){this.data={name:null},e.name!==void 0&&this.name(e.name)}name(e){return e===void 0?this.data.name:(this.data.name=e||null,this)}toJSON(){return Object.assign({},this.data)}toString(){if(!this.data.name)throw new Error("No value for `name` in ICalCategory given!");return(0,st.escape)(this.data.name,!1)}}v.default=ot;var L={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ICalWeekday=i.ICalEventRepeatingFreq=void 0,function(e){e.SECONDLY="SECONDLY",e.MINUTELY="MINUTELY",e.HOURLY="HOURLY",e.DAILY="DAILY",e.WEEKLY="WEEKLY",e.MONTHLY="MONTHLY",e.YEARLY="YEARLY"}(i.ICalEventRepeatingFreq||(i.ICalEventRepeatingFreq={})),function(e){e.SU="SU",e.MO="MO",e.TU="TU",e.WE="WE",e.TH="TH",e.FR="FR",e.SA="SA"}(i.ICalWeekday||(i.ICalWeekday={}))})(L);(function(i){var e=A&&A.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(i,"__esModule",{value:!0}),i.ICalEventClass=i.ICalEventTransparency=i.ICalEventBusyStatus=i.ICalEventStatus=void 0;const o=e(O),n=c,u=e(N),r=e(M),h=e(v),s=L;var a;(function(p){p.CONFIRMED="CONFIRMED",p.TENTATIVE="TENTATIVE",p.CANCELLED="CANCELLED"})(a=i.ICalEventStatus||(i.ICalEventStatus={}));var d;(function(p){p.FREE="FREE",p.TENTATIVE="TENTATIVE",p.BUSY="BUSY",p.OOF="OOF"})(d=i.ICalEventBusyStatus||(i.ICalEventBusyStatus={}));var m;(function(p){p.TRANSPARENT="TRANSPARENT",p.OPAQUE="OPAQUE"})(m=i.ICalEventTransparency||(i.ICalEventTransparency={}));var T;(function(p){p.PUBLIC="PUBLIC",p.PRIVATE="PRIVATE",p.CONFIDENTIAL="CONFIDENTIAL"})(T=i.ICalEventClass||(i.ICalEventClass={}));class E{constructor(t,f){if(this.data={id:(0,o.default)(),sequence:0,start:null,end:null,recurrenceId:null,timezone:null,stamp:new Date,allDay:!1,floating:!1,repeating:null,summary:"",location:null,description:null,organizer:null,attendees:[],alarms:[],categories:[],status:null,busystatus:null,priority:null,url:null,attachments:[],transparency:null,created:null,lastModified:null,class:null,x:[]},this.calendar=f,!f)throw new Error("`calendar` option required!");t.id&&this.id(t.id),t.sequence!==void 0&&this.sequence(t.sequence),t.start&&this.start(t.start),t.end!==void 0&&this.end(t.end),t.recurrenceId!==void 0&&this.recurrenceId(t.recurrenceId),t.timezone!==void 0&&this.timezone(t.timezone),t.stamp!==void 0&&this.stamp(t.stamp),t.allDay!==void 0&&this.allDay(t.allDay),t.floating!==void 0&&this.floating(t.floating),t.repeating!==void 0&&this.repeating(t.repeating),t.summary!==void 0&&this.summary(t.summary),t.location!==void 0&&this.location(t.location),t.description!==void 0&&this.description(t.description),t.organizer!==void 0&&this.organizer(t.organizer),t.attendees!==void 0&&this.attendees(t.attendees),t.alarms!==void 0&&this.alarms(t.alarms),t.categories!==void 0&&this.categories(t.categories),t.status!==void 0&&this.status(t.status),t.busystatus!==void 0&&this.busystatus(t.busystatus),t.priority!==void 0&&this.priority(t.priority),t.url!==void 0&&this.url(t.url),t.attachments!==void 0&&this.attachments(t.attachments),t.transparency!==void 0&&this.transparency(t.transparency),t.created!==void 0&&this.created(t.created),t.lastModified!==void 0&&this.lastModified(t.lastModified),t.class!==void 0&&this.class(t.class),t.x!==void 0&&this.x(t.x)}id(t){return t===void 0?this.data.id:(this.data.id=String(t),this)}uid(t){return t===void 0?this.id():this.id(t)}sequence(t){if(t===void 0)return this.data.sequence;const f=parseInt(String(t),10);if(isNaN(f))throw new Error("`sequence` must be a number!");return this.data.sequence=t,this}start(t){if(t===void 0)return this.data.start;if(this.data.start=(0,n.checkDate)(t,"start"),this.data.start&&this.data.end&&(0,n.toDate)(this.data.start).getTime()>(0,n.toDate)(this.data.end).getTime()){const f=this.data.start;this.data.start=this.data.end,this.data.end=f}return this}end(t){if(t===void 0)return this.data.end;if(t===null)return this.data.end=null,this;if(this.data.end=(0,n.checkDate)(t,"end"),this.data.start&&this.data.end&&(0,n.toDate)(this.data.start).getTime()>(0,n.toDate)(this.data.end).getTime()){const f=this.data.start;this.data.start=this.data.end,this.data.end=f}return this}recurrenceId(t){return t===void 0?this.data.recurrenceId:t===null?(this.data.recurrenceId=null,this):(this.data.recurrenceId=(0,n.checkDate)(t,"recurrenceId"),this)}timezone(t){return t===void 0&&this.data.timezone!==null?this.data.timezone:t===void 0?this.calendar.timezone():(this.data.timezone=t&&t!=="UTC"?t.toString():null,this.data.timezone&&(this.data.floating=!1),this)}stamp(t){return t===void 0?this.data.stamp:(this.data.stamp=(0,n.checkDate)(t,"stamp"),this)}timestamp(t){return t===void 0?this.stamp():this.stamp(t)}allDay(t){return t===void 0?this.data.allDay:(this.data.allDay=!!t,this)}floating(t){return t===void 0?this.data.floating:(this.data.floating=!!t,this.data.floating&&(this.data.timezone=null),this)}repeating(t){if(t===void 0)return this.data.repeating;if(!t)return this.data.repeating=null,this;if((0,n.isRRule)(t)||typeof t=="string")return this.data.repeating=t,this;if(this.data.repeating={freq:(0,n.checkEnum)(s.ICalEventRepeatingFreq,t.freq)},t.count){if(!isFinite(t.count))throw new Error("`repeating.count` must be a finite number!");this.data.repeating.count=t.count}if(t.interval){if(!isFinite(t.interval))throw new Error("`repeating.interval` must be a finite number!");this.data.repeating.interval=t.interval}if(t.until!==void 0&&(this.data.repeating.until=(0,n.checkDate)(t.until,"repeating.until")),t.byDay){const f=Array.isArray(t.byDay)?t.byDay:[t.byDay];this.data.repeating.byDay=f.map(g=>(0,n.checkEnum)(s.ICalWeekday,g))}if(t.byMonth){const f=Array.isArray(t.byMonth)?t.byMonth:[t.byMonth];this.data.repeating.byMonth=f.map(g=>{if(typeof g!="number"||g<1||g>12)throw new Error("`repeating.byMonth` contains invalid value `"+g+"`!");return g})}if(t.byMonthDay){const f=Array.isArray(t.byMonthDay)?t.byMonthDay:[t.byMonthDay];this.data.repeating.byMonthDay=f.map(g=>{if(typeof g!="number"||g<-31||g>31||g===0)throw new Error("`repeating.byMonthDay` contains invalid value `"+g+"`!");return g})}if(t.bySetPos){if(!this.data.repeating.byDay)throw"`repeating.bySetPos` must be used along with `repeating.byDay`!";const f=Array.isArray(t.bySetPos)?t.bySetPos:[t.bySetPos];this.data.repeating.bySetPos=f.map(g=>{if(typeof g!="number"||g<-366||g>366||g===0)throw"`repeating.bySetPos` contains invalid value `"+g+"`!";return g})}if(t.exclude){const f=Array.isArray(t.exclude)?t.exclude:[t.exclude];this.data.repeating.exclude=f.map((g,b)=>(0,n.checkDate)(g,`repeating.exclude[${b}]`))}return t.startOfWeek&&(this.data.repeating.startOfWeek=(0,n.checkEnum)(s.ICalWeekday,t.startOfWeek)),this}summary(t){return t===void 0?this.data.summary:(this.data.summary=t?String(t):"",this)}location(t){if(t===void 0)return this.data.location;if(typeof t=="string")return this.data.location={title:t},this;if(t&&!t.title||t!=null&&t.geo&&(!isFinite(t.geo.lat)||!isFinite(t.geo.lon)))throw new Error("`location` isn't formatted correctly. See https://sebbo2002.github.io/ical-generator/develop/reference/classes/ICalEvent.html#location");return this.data.location=t||null,this}description(t){return t===void 0?this.data.description:t===null?(this.data.description=null,this):(typeof t=="string"?this.data.description={plain:t}:this.data.description=t,this)}organizer(t){return t===void 0?this.data.organizer:t===null?(this.data.organizer=null,this):(this.data.organizer=(0,n.checkNameAndMail)("organizer",t),this)}createAttendee(t={}){if(t instanceof u.default)return this.data.attendees.push(t),t;typeof t=="string"&&(t=(0,n.checkNameAndMail)("data",t));const f=new u.default(t,this);return this.data.attendees.push(f),f}attendees(t){return t?(t.forEach(f=>this.createAttendee(f)),this):this.data.attendees}createAlarm(t={}){const f=t instanceof r.default?t:new r.default(t,this);return this.data.alarms.push(f),f}alarms(t){return t?(t.forEach(f=>this.createAlarm(f)),this):this.data.alarms}createCategory(t={}){const f=t instanceof h.default?t:new h.default(t);return this.data.categories.push(f),f}categories(t){return t?(t.forEach(f=>this.createCategory(f)),this):this.data.categories}status(t){return t===void 0?this.data.status:t===null?(this.data.status=null,this):(this.data.status=(0,n.checkEnum)(a,t),this)}busystatus(t){return t===void 0?this.data.busystatus:t===null?(this.data.busystatus=null,this):(this.data.busystatus=(0,n.checkEnum)(d,t),this)}priority(t){if(t===void 0)return this.data.priority;if(t===null)return this.data.priority=null,this;if(t<0||t>9)throw new Error("`priority` is invalid, musst be 0 ≤ priority ≤ 9.");return this.data.priority=Math.round(t),this}url(t){return t===void 0?this.data.url:(this.data.url=t?String(t):null,this)}createAttachment(t){return this.data.attachments.push(t),this}attachments(t){return t?(t.forEach(f=>this.createAttachment(f)),this):this.data.attachments}transparency(t){return t===void 0?this.data.transparency:t?(this.data.transparency=(0,n.checkEnum)(m,t),this):(this.data.transparency=null,this)}created(t){return t===void 0?this.data.created:t===null?(this.data.created=null,this):(this.data.created=(0,n.checkDate)(t,"created"),this)}lastModified(t){return t===void 0?this.data.lastModified:t===null?(this.data.lastModified=null,this):(this.data.lastModified=(0,n.checkDate)(t,"lastModified"),this)}class(t){return t===void 0?this.data.class:t===null?(this.data.class=null,this):(this.data.class=(0,n.checkEnum)(T,t),this)}x(t,f){return t===void 0?(0,n.addOrGetCustomAttributes)(this.data):(typeof t=="string"&&typeof f=="string"&&(0,n.addOrGetCustomAttributes)(this.data,t,f),typeof t=="object"&&(0,n.addOrGetCustomAttributes)(this.data,t),this)}toJSON(){var t;let f=null;return(0,n.isRRule)(this.data.repeating)||typeof this.data.repeating=="string"?f=this.data.repeating.toString():this.data.repeating&&(f=Object.assign({},this.data.repeating,{until:(0,n.toJSON)(this.data.repeating.until),exclude:(t=this.data.repeating.exclude)===null||t===void 0?void 0:t.map(g=>(0,n.toJSON)(g))})),Object.assign({},this.data,{start:(0,n.toJSON)(this.data.start)||null,end:(0,n.toJSON)(this.data.end)||null,recurrenceId:(0,n.toJSON)(this.data.recurrenceId)||null,stamp:(0,n.toJSON)(this.data.stamp)||null,created:(0,n.toJSON)(this.data.created)||null,lastModified:(0,n.toJSON)(this.data.lastModified)||null,repeating:f,x:this.x()})}toString(){var t,f,g,b,D;let l="";if(!this.data.start)throw new Error("No value for `start` in ICalEvent #"+this.data.id+" given!");return l+=`BEGIN:VEVENT\r
`,l+="UID:"+this.data.id+`\r
`,l+="SEQUENCE:"+this.data.sequence+`\r
`,l+="DTSTAMP:"+(0,n.formatDate)(this.calendar.timezone(),this.data.stamp)+`\r
`,this.data.allDay?(l+="DTSTART;VALUE=DATE:"+(0,n.formatDate)(this.calendar.timezone(),this.data.start,!0)+`\r
`,this.data.end&&(l+="DTEND;VALUE=DATE:"+(0,n.formatDate)(this.calendar.timezone(),this.data.end,!0)+`\r
`),l+=`X-MICROSOFT-CDO-ALLDAYEVENT:TRUE\r
`,l+=`X-MICROSOFT-MSNCALENDAR-ALLDAYEVENT:TRUE\r
`):(l+=(0,n.formatDateTZ)(this.timezone(),"DTSTART",this.data.start,this.data)+`\r
`,this.data.end&&(l+=(0,n.formatDateTZ)(this.timezone(),"DTEND",this.data.end,this.data)+`\r
`)),(0,n.isRRule)(this.data.repeating)||typeof this.data.repeating=="string"?l+=this.data.repeating.toString().replace(/\r\n/g,`
`).split(`
`).filter(y=>y&&!y.startsWith("DTSTART:")).join(`\r
`)+`\r
`:this.data.repeating&&(l+="RRULE:FREQ="+this.data.repeating.freq,this.data.repeating.count&&(l+=";COUNT="+this.data.repeating.count),this.data.repeating.interval&&(l+=";INTERVAL="+this.data.repeating.interval),this.data.repeating.until&&(l+=";UNTIL="+(0,n.formatDate)(this.calendar.timezone(),this.data.repeating.until,!1,this.floating())),this.data.repeating.byDay&&(l+=";BYDAY="+this.data.repeating.byDay.join(",")),this.data.repeating.byMonth&&(l+=";BYMONTH="+this.data.repeating.byMonth.join(",")),this.data.repeating.byMonthDay&&(l+=";BYMONTHDAY="+this.data.repeating.byMonthDay.join(",")),this.data.repeating.bySetPos&&(l+=";BYSETPOS="+this.data.repeating.bySetPos.join(",")),this.data.repeating.startOfWeek&&(l+=";WKST="+this.data.repeating.startOfWeek),l+=`\r
`,this.data.repeating.exclude&&(this.data.allDay?l+="EXDATE;VALUE=DATE:"+this.data.repeating.exclude.map(y=>(0,n.formatDate)(this.calendar.timezone(),y,!0)).join(",")+`\r
`:(l+="EXDATE",this.timezone()?l+=";TZID="+this.timezone()+":"+this.data.repeating.exclude.map(y=>(0,n.formatDate)(this.timezone(),y,!1,!0)).join(",")+`\r
`:l+=":"+this.data.repeating.exclude.map(y=>(0,n.formatDate)(this.timezone(),y,!1,this.floating())).join(",")+`\r
`))),this.data.recurrenceId&&(l+=(0,n.formatDateTZ)(this.timezone(),"RECURRENCE-ID",this.data.recurrenceId,this.data)+`\r
`),l+="SUMMARY:"+(0,n.escape)(this.data.summary,!1)+`\r
`,this.data.transparency&&(l+="TRANSP:"+(0,n.escape)(this.data.transparency,!1)+`\r
`),!((t=this.data.location)===null||t===void 0)&&t.title&&(l+="LOCATION:"+(0,n.escape)(this.data.location.title+(this.data.location.address?`
`+this.data.location.address:""),!1)+`\r
`,this.data.location.radius&&this.data.location.geo&&(l+="X-APPLE-STRUCTURED-LOCATION;VALUE=URI;"+(this.data.location.address?"X-ADDRESS="+(0,n.escape)(this.data.location.address,!1)+";":"")+"X-APPLE-RADIUS="+(0,n.escape)(this.data.location.radius,!1)+";X-TITLE="+(0,n.escape)(this.data.location.title,!1)+":geo:"+(0,n.escape)((f=this.data.location.geo)===null||f===void 0?void 0:f.lat,!1)+","+(0,n.escape)((g=this.data.location.geo)===null||g===void 0?void 0:g.lon,!1)+`\r
`),this.data.location.geo&&(l+="GEO:"+(0,n.escape)((b=this.data.location.geo)===null||b===void 0?void 0:b.lat,!1)+";"+(0,n.escape)((D=this.data.location.geo)===null||D===void 0?void 0:D.lon,!1)+`\r
`)),this.data.description&&(l+="DESCRIPTION:"+(0,n.escape)(this.data.description.plain,!1)+`\r
`,this.data.description.html&&(l+="X-ALT-DESC;FMTTYPE=text/html:"+(0,n.escape)(this.data.description.html,!1)+`\r
`)),this.data.organizer&&(l+='ORGANIZER;CN="'+(0,n.escape)(this.data.organizer.name,!0)+'"',this.data.organizer.sentBy&&(l+=';SENT-BY="mailto:'+(0,n.escape)(this.data.organizer.sentBy,!0)+'"'),this.data.organizer.email&&this.data.organizer.mailto&&(l+=";EMAIL="+(0,n.escape)(this.data.organizer.email,!1)),this.data.organizer.email&&(l+=":mailto:"+(0,n.escape)(this.data.organizer.mailto||this.data.organizer.email,!1)),l+=`\r
`),this.data.attendees.forEach(function(y){l+=y.toString()}),this.data.alarms.forEach(function(y){l+=y.toString()}),this.data.categories.length>0&&(l+="CATEGORIES:"+this.data.categories.map(function(y){return y.toString()}).join()+`\r
`),this.data.url&&(l+="URL;VALUE=URI:"+(0,n.escape)(this.data.url,!1)+`\r
`),this.data.attachments.length>0&&this.data.attachments.forEach(y=>{l+="ATTACH:"+(0,n.escape)(y,!1)+`\r
`}),this.data.status&&(l+="STATUS:"+this.data.status.toUpperCase()+`\r
`),this.data.busystatus&&(l+="X-MICROSOFT-CDO-BUSYSTATUS:"+this.data.busystatus.toUpperCase()+`\r
`),this.data.priority!==null&&(l+="PRIORITY:"+this.data.priority+`\r
`),l+=(0,n.generateCustomAttributes)(this.data),this.data.created&&(l+="CREATED:"+(0,n.formatDate)(this.calendar.timezone(),this.data.created)+`\r
`),this.data.lastModified&&(l+="LAST-MODIFIED:"+(0,n.formatDate)(this.calendar.timezone(),this.data.lastModified)+`\r
`),this.data.class&&(l+="CLASS:"+this.data.class.toUpperCase()+`\r
`),l+=`END:VEVENT\r
`,l}}i.default=E})(w);(function(i){var e=A&&A.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(i,"__esModule",{value:!0}),i.ICalCalendarMethod=void 0;const o=c,n=e(w),u=z;var r;(function(s){s.PUBLISH="PUBLISH",s.REQUEST="REQUEST",s.REPLY="REPLY",s.ADD="ADD",s.CANCEL="CANCEL",s.REFRESH="REFRESH",s.COUNTER="COUNTER",s.DECLINECOUNTER="DECLINECOUNTER"})(r=i.ICalCalendarMethod||(i.ICalCalendarMethod={}));class h{constructor(a={}){this.data={prodId:"//sebbo.net//ical-generator//EN",method:null,name:null,description:null,timezone:null,source:null,url:null,scale:null,ttl:null,events:[],x:[]},a.prodId!==void 0&&this.prodId(a.prodId),a.method!==void 0&&this.method(a.method),a.name!==void 0&&this.name(a.name),a.description!==void 0&&this.description(a.description),a.timezone!==void 0&&this.timezone(a.timezone),a.source!==void 0&&this.source(a.source),a.url!==void 0&&this.url(a.url),a.scale!==void 0&&this.scale(a.scale),a.ttl!==void 0&&this.ttl(a.ttl),a.events!==void 0&&this.events(a.events),a.x!==void 0&&this.x(a.x)}prodId(a){if(!a)return this.data.prodId;if(typeof a=="string"&&/^\/\/(.+)\/\/(.+)\/\/([A-Z]{1,4})$/.test(a))return this.data.prodId=a,this;if(typeof a=="string")throw new Error("`prodId` isn't formated correctly. See https://sebbo2002.github.io/ical-generator/develop/reference/classes/ICalCalendar.html#prodId");if(typeof a!="object")throw new Error("`prodid` needs to be a valid formed string or an object!");if(!a.company)throw new Error("`prodid.company` is a mandatory item!");if(!a.product)throw new Error("`prodid.product` is a mandatory item!");const m=(a.language||"EN").toUpperCase();return this.data.prodId="//"+a.company+"//"+a.product+"//"+m,this}method(a){return a===void 0?this.data.method:a?(this.data.method=(0,o.checkEnum)(r,a),this):(this.data.method=null,this)}name(a){return a===void 0?this.data.name:(this.data.name=a?String(a):null,this)}description(a){return a===void 0?this.data.description:(this.data.description=a?String(a):null,this)}timezone(a){var d;return a===void 0?((d=this.data.timezone)===null||d===void 0?void 0:d.name)||null:(a==="UTC"?this.data.timezone=null:typeof a=="string"?this.data.timezone={name:a}:a===null?this.data.timezone=null:this.data.timezone=a,this)}source(a){return a===void 0?this.data.source:(this.data.source=a||null,this)}url(a){return a===void 0?this.data.url:(this.data.url=a||null,this)}scale(a){return a===void 0?this.data.scale:(a===null?this.data.scale=null:this.data.scale=a.toUpperCase(),this)}ttl(a){return a===void 0?this.data.ttl:((0,o.isMomentDuration)(a)?this.data.ttl=a.asSeconds():a&&a>0?this.data.ttl=a:this.data.ttl=null,this)}createEvent(a){const d=a instanceof n.default?a:new n.default(a,this);return this.data.events.push(d),d}events(a){return a?(a.forEach(d=>this.createEvent(d)),this):this.data.events}clear(){return this.data.events=[],this}save(a,d){return d?((0,u.writeFile)(a,this.toString(),d),this):u.promises.writeFile(a,this.toString())}saveSync(a){return(0,u.writeFileSync)(a,this.toString()),this}serve(a,d="calendar.ics"){return a.writeHead(200,{"Content-Type":"text/calendar; charset=utf-8","Content-Disposition":`attachment; filename="${d}"`}),a.end(this.toString()),this}toBlob(){return new Blob([this.toString()],{type:"text/calendar"})}toURL(){return URL.createObjectURL(this.toBlob())}x(a,d){if(a===void 0)return(0,o.addOrGetCustomAttributes)(this.data);if(typeof a=="string"&&typeof d=="string")(0,o.addOrGetCustomAttributes)(this.data,a,d);else if(typeof a=="object")(0,o.addOrGetCustomAttributes)(this.data,a);else throw new Error("Either key or value is not a string!");return this}toJSON(){return Object.assign({},this.data,{timezone:this.timezone(),events:this.data.events.map(a=>a.toJSON()),x:this.x()})}length(){return this.data.events.length}toString(){var a,d;let m="";return m=`BEGIN:VCALENDAR\r
VERSION:2.0\r
`,m+="PRODID:-"+this.data.prodId+`\r
`,this.data.url&&(m+="URL:"+this.data.url+`\r
`),this.data.source&&(m+="SOURCE;VALUE=URI:"+this.data.source+`\r
`),this.data.scale&&(m+="CALSCALE:"+this.data.scale+`\r
`),this.data.method&&(m+="METHOD:"+this.data.method+`\r
`),this.data.name&&(m+="NAME:"+this.data.name+`\r
`,m+="X-WR-CALNAME:"+this.data.name+`\r
`),this.data.description&&(m+="X-WR-CALDESC:"+this.data.description+`\r
`),!((a=this.data.timezone)===null||a===void 0)&&a.generator&&[...new Set([this.timezone(),...this.data.events.map(E=>E.timezone())])].filter(E=>E!==null&&!E.startsWith("/")).forEach(E=>{var p;if(!(!((p=this.data.timezone)===null||p===void 0)&&p.generator))return;const t=this.data.timezone.generator(E);t&&(m+=t.replace(/\r\n/g,`
`).replace(/\n/g,`\r
`).trim()+`\r
`)}),!((d=this.data.timezone)===null||d===void 0)&&d.name&&(m+="TIMEZONE-ID:"+this.data.timezone.name+`\r
`,m+="X-WR-TIMEZONE:"+this.data.timezone.name+`\r
`),this.data.ttl&&(m+="REFRESH-INTERVAL;VALUE=DURATION:"+(0,o.toDurationString)(this.data.ttl)+`\r
`,m+="X-PUBLISHED-TTL:"+(0,o.toDurationString)(this.data.ttl)+`\r
`),this.data.events.forEach(T=>m+=T.toString()),m+=(0,o.generateCustomAttributes)(this.data),m+="END:VCALENDAR",(0,o.foldLines)(m)}}i.default=h})(R);(function(i,e){var o=A&&A.__importDefault||function(E){return E&&E.__esModule?E:{default:E}};Object.defineProperty(e,"__esModule",{value:!0}),e.foldLines=e.escape=e.formatDateTZ=e.formatDate=e.ICalWeekday=e.ICalEventRepeatingFreq=e.ICalEventClass=e.ICalEventTransparency=e.ICalEventBusyStatus=e.ICalEventStatus=e.ICalEvent=e.ICalCategory=e.ICalCalendarMethod=e.ICalCalendar=e.ICalAttendeeStatus=e.ICalAttendeeRole=e.ICalAttendeeType=e.ICalAttendee=e.ICalAlarmType=e.ICalAlarm=void 0;const n=o(R);function u(E){return new n.default(E)}e.default=u;var r=M;Object.defineProperty(e,"ICalAlarm",{enumerable:!0,get:function(){return o(r).default}}),Object.defineProperty(e,"ICalAlarmType",{enumerable:!0,get:function(){return r.ICalAlarmType}});var h=N;Object.defineProperty(e,"ICalAttendee",{enumerable:!0,get:function(){return o(h).default}}),Object.defineProperty(e,"ICalAttendeeType",{enumerable:!0,get:function(){return h.ICalAttendeeType}}),Object.defineProperty(e,"ICalAttendeeRole",{enumerable:!0,get:function(){return h.ICalAttendeeRole}}),Object.defineProperty(e,"ICalAttendeeStatus",{enumerable:!0,get:function(){return h.ICalAttendeeStatus}});var s=R;Object.defineProperty(e,"ICalCalendar",{enumerable:!0,get:function(){return o(s).default}}),Object.defineProperty(e,"ICalCalendarMethod",{enumerable:!0,get:function(){return s.ICalCalendarMethod}});var a=v;Object.defineProperty(e,"ICalCategory",{enumerable:!0,get:function(){return o(a).default}});var d=w;Object.defineProperty(e,"ICalEvent",{enumerable:!0,get:function(){return o(d).default}}),Object.defineProperty(e,"ICalEventStatus",{enumerable:!0,get:function(){return d.ICalEventStatus}}),Object.defineProperty(e,"ICalEventBusyStatus",{enumerable:!0,get:function(){return d.ICalEventBusyStatus}}),Object.defineProperty(e,"ICalEventTransparency",{enumerable:!0,get:function(){return d.ICalEventTransparency}}),Object.defineProperty(e,"ICalEventClass",{enumerable:!0,get:function(){return d.ICalEventClass}});var m=L;Object.defineProperty(e,"ICalEventRepeatingFreq",{enumerable:!0,get:function(){return m.ICalEventRepeatingFreq}}),Object.defineProperty(e,"ICalWeekday",{enumerable:!0,get:function(){return m.ICalWeekday}});var T=c;Object.defineProperty(e,"formatDate",{enumerable:!0,get:function(){return T.formatDate}}),Object.defineProperty(e,"formatDateTZ",{enumerable:!0,get:function(){return T.formatDateTZ}}),Object.defineProperty(e,"escape",{enumerable:!0,get:function(){return T.escape}}),Object.defineProperty(e,"foldLines",{enumerable:!0,get:function(){return T.foldLines}}),i.exports=Object.assign(u,i.exports)})(H,C);const ut=G(C);function _(i){let[e,o]=i.split(" "),[n,u]=e.split(":");if(o=o.replace(".",""),n==="12"&&(n="00"),o=="PM")n=(parseInt(n,10)+12).toString();else if(parseInt(n,10)<10)return`0${n}:${u}:00`;return`${n}:${u}:00`}function dt(i,e){const o=e["B.SUBJECT"],n=e["B.CATALOG_NBR"],u=e["B.DESCR"],r=`${o} ${n} - ${u}`,h=e["G.DESCR"],s=e["F.ROOM"],a=e["F.DESCR"],d=`${h} / ${s} / ${a}`,T=e["D.D_XLATSHORTNAME"],E=e["E.START_DT"],p=e["E.END_DT"],t=e.START_TIME,f=e.END_TIME,g=_(t),b=_(f),D=new Date(Date.parse(`${E}T${g}`)),l=new Date(Date.parse(`${E}T${b}`));let y=new Date(Date.parse(E)),U=new Date(Date.parse(p));U.getTime()-y.getTime(),console.log(o,D,E,g);const Y={freq:C.ICalEventRepeatingFreq.WEEKLY,until:U};i.createEvent({summary:r,location:d,description:T,start:D,end:l,repeating:Y})}function lt(i,e){let o=ut({name:i});console.log(e),e.status!=="success"&&console.error("API response was not successful!"),e.data.query["queryname="]!=="TIMETABLE_LIST"&&console.error("Data is not timetable list, cannot proceed further");const n=e.data.query.numrows,u=e.data.query.rows;for(let r=0;r<n;++r)dt(o,u[r]);return o}function ft(i){const e=i.toBlob();return URL.createObjectURL(e)}console.log("main.js initialized");const ht=document.getElementById("btn");ht.onclick=ct;async function ct(){let i={};await browser.storage.local.get().then(u=>i=u),console.log(i);let e=lt("test",i);console.log("calander");let o=ft(e);console.log(o);const n=document.createElement("a");n.href=o,n.download="test.ical",n.click()}
